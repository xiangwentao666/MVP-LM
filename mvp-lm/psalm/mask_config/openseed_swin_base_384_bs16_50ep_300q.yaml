_BASE_: ./maskformer2_R50_bs16_50ep.yaml
MODEL:
  SEM_SEG_HEAD:
    NAME: encoder_deform
    IGNORE_VALUE: 255
    NUM_CLASSES: 133
    LOSS_WEIGHT: 1.0
    CONVS_DIM: 256
    MASK_DIM: 256
    NORM: "GN"
    IN_FEATURES: [ "res2", "res3", "res4", "res5" ]
    DEFORMABLE_TRANSFORMER_ENCODER_IN_FEATURES: [ "res3", "res4", "res5" ]
    COMMON_STRIDE: 4
    TRANSFORMER_ENC_LAYERS: 6
    TOTAL_NUM_FEATURE_LEVELS: 4
    NUM_FEATURE_LEVELS: 3
    FEATURE_ORDER: "low2high"
  MASK_FORMER:
    NUM_OBJECT_QUERIES: 300
    TOTAL_NUM_FEATURE_LEVELS: 4
    INITIAL_PRED: True
    DN: seg
    DN_NOISE_SCALE: 0.4
    DN_NUM: 100
    CLASS_WEIGHT: 2.0
    DICE_WEIGHT: 5.0
    MASK_WEIGHT: 5.0
    BOX_WEIGHT: 5.0
    GIOU_WEIGHT: 2.0
  BACKBONE:
    NAME: "D2SwinTransformer"
  SWIN:
    # EMBED_DIM: 96
    # DEPTHS: [2, 2, 6, 2]
    # NUM_HEADS: [ 3, 6, 12, 24 ]
    # WINDOW_SIZE: 7
    # PRETRAIN_IMG_SIZE: 224
    EMBED_DIM: 128
    DEPTHS: [2, 2, 18, 2]
    NUM_HEADS: [4, 8, 16, 32]
    WINDOW_SIZE: 12
    PRETRAIN_IMG_SIZE: 384
    APE: False
    DROP_PATH_RATE: 0.3
    PATCH_NORM: True
    OUT_FEATURES: ["res2", "res3", "res4", "res5"]
  WEIGHTS: "swin_base_patch4_window12_384.pkl"
  PIXEL_MEAN: [123.675, 116.280, 103.530]
  PIXEL_STD: [58.395, 57.120, 57.375]


